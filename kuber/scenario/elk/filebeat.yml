apiVersion: v1
kind: Namespace
metadata:
  name: elk
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: log-generator-pvc
  namespace: elk
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: standard
  resources:
    requests:
      storage: 10Mi
---
# app-pod.yaml
apiVersion: v1
kind: Pod
metadata:
  name: log-generator
  namespace: elk
spec:
  containers:
    - name: log-generator
      image: busybox
      command: ["sh", "-c", "while true; do echo 'App Log' >> /logs/app.log; sleep 5; done"]
      volumeMounts:
        - name: log-generator-data
          mountPath: /logs
  volumes:
    - name: log-generator-data
      persistentVolumeClaim:
        claimName: log-generator-pvc
  nodeSelector:
    size: small
---
apiVersion: v1
kind: Pod
metadata:
  name: filebeat-ish
  namespace: elk
spec:
  containers:
    - name: filebeat-ish
      image: busybox
      volumeMounts:
        - name: filebeat-ish-data
          mountPath: /logs
  volumes:
    - name: filebeat-ish-data
      persistentVolumeClaim:
        claimName: log-generator-pvc
  nodeSelector:
    size: small